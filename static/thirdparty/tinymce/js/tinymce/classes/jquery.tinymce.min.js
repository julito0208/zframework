
(function($){var undef,lazyLoading,delayedInits=[],win=window;$.fn.tinymce=function(settings){var self=this,url,base,lang,suffix="",patchApplied;if(!self.length){return self;}
if(!settings){return window.tinymce?tinymce.get(self[0].id):null;}
self.css('visibility','hidden');function init(){var editors=[],initCount=0;if(!patchApplied){applyPatch();patchApplied=true;}
self.each(function(i,node){var ed,id=node.id,oninit=settings.oninit;if(!id){node.id=id=tinymce.DOM.uniqueId();}
if(tinymce.get(id)){return;}
ed=new tinymce.Editor(id,settings,tinymce.EditorManager);editors.push(ed);ed.on('init',function(){var scope,func=oninit;self.css('visibility','');if(oninit){if(++initCount==editors.length){if(typeof(func)==="string"){scope=(func.indexOf(".")===-1)?null:tinymce.resolve(func.replace(/\.\w+$/,""));func=tinymce.resolve(func);}
func.apply(scope||tinymce,editors);}}});});$.each(editors,function(i,ed){ed.render();});}
if(!win.tinymce&&!lazyLoading&&(url=settings.script_url)){lazyLoading=1;base=url.substring(0,url.lastIndexOf("/"));if(url.indexOf('.min')!=-1){suffix=".min";}
win.tinymce=win.tinyMCEPreInit||{base:base,suffix:suffix};if(url.indexOf('gzip')!=-1){lang=settings.language||"en";url=url+(/\?/.test(url)?'&':'?')+"js=true&core=true&suffix="+escape(suffix)+"&themes="+escape(settings.theme||'modern')+"&plugins="+
escape(settings.plugins||'')+"&languages="+(lang||'');if(!win.tinyMCE_GZ){win.tinyMCE_GZ={start:function(){function load(url){tinymce.ScriptLoader.markDone(tinymce.baseURI.toAbsolute(url));}
load("langs/"+lang+".js");load("themes/"+settings.theme+"/theme"+suffix+".js");load("themes/"+settings.theme+"/langs/"+lang+".js");$.each(settings.plugins.split(","),function(i,name){if(name){load("plugins/"+name+"/plugin"+suffix+".js");load("plugins/"+name+"/langs/"+lang+".js");}});},end:function(){}};}}
var script=document.createElement('script');script.type='text/javascript';script.onload=script.onreadystatechange=function(e){e=e||window.event;if(lazyLoading!==2&&(e.type=='load'||/complete|loaded/.test(script.readyState))){tinymce.dom.Event.domLoaded=1;lazyLoading=2;if(settings.script_loaded){settings.script_loaded();}
init();$.each(delayedInits,function(i,init){init();});}};script.src=url;document.body.appendChild(script);}else{if(lazyLoading===1){delayedInits.push(init);}else{init();}}
return self;};$.extend($.expr[":"],{tinymce:function(e){return!!(e.id&&"tinymce"in window&&tinymce.get(e.id));}});function applyPatch(){function removeEditors(name){if(name==="remove"){this.each(function(i,node){var ed=tinyMCEInstance(node);if(ed){ed.remove();}});}
this.find("span.mceEditor,div.mceEditor").each(function(i,node){var ed=tinymce.get(node.id.replace(/_parent$/,""));if(ed){ed.remove();}});}
function loadOrSave(value){var self=this,ed;if(value!=null){removeEditors.call(self);self.each(function(i,node){var ed;if((ed=tinymce.get(node.id))){ed.setContent(value);}});}else if(self.length>0){if((ed=tinymce.get(self[0].id))){return ed.getContent();}}}
function tinyMCEInstance(element){var ed=null;if(element&&element.id&&win.tinymce){ed=tinymce.get(element.id);}
return ed;}
function containsTinyMCE(matchedSet){return!!((matchedSet)&&(matchedSet.length)&&(win.tinymce)&&(matchedSet.is(":tinymce")));}
var jQueryFn={};$.each(["text","html","val"],function(i,name){var origFn=jQueryFn[name]=$.fn[name],textProc=(name==="text");$.fn[name]=function(value){var self=this;if(!containsTinyMCE(self)){return origFn.apply(self,arguments);}
if(value!==undef){loadOrSave.call(self.filter(":tinymce"),value);origFn.apply(self.not(":tinymce"),arguments);return self;}else{var ret="";var args=arguments;(textProc?self:self.eq(0)).each(function(i,node){var ed=tinyMCEInstance(node);if(ed){ret+=textProc?ed.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):ed.getContent({save:true});}else{ret+=origFn.apply($(node),args);}});return ret;}};});$.each(["append","prepend"],function(i,name){var origFn=jQueryFn[name]=$.fn[name],prepend=(name==="prepend");$.fn[name]=function(value){var self=this;if(!containsTinyMCE(self)){return origFn.apply(self,arguments);}
if(value!==undef){self.filter(":tinymce").each(function(i,node){var ed=tinyMCEInstance(node);if(ed){ed.setContent(prepend?value+ed.getContent():ed.getContent()+value);}});origFn.apply(self.not(":tinymce"),arguments);return self;}};});$.each(["remove","replaceWith","replaceAll","empty"],function(i,name){var origFn=jQueryFn[name]=$.fn[name];$.fn[name]=function(){removeEditors.call(this,name);return origFn.apply(this,arguments);};});jQueryFn.attr=$.fn.attr;$.fn.attr=function(name,value){var self=this,args=arguments;if((!name)||(name!=="value")||(!containsTinyMCE(self))){if(value!==undef){return jQueryFn.attr.apply(self,args);}else{return jQueryFn.attr.apply(self,args);}}
if(value!==undef){loadOrSave.call(self.filter(":tinymce"),value);jQueryFn.attr.apply(self.not(":tinymce"),args);return self;}else{var node=self[0],ed=tinyMCEInstance(node);return ed?ed.getContent({save:true}):jQueryFn.attr.apply($(node),args);}};}})(jQuery);