
define("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/util/EventDispatcher","tinymce/ui/Collection","tinymce/ui/DomUtils"],function(Class,Tools,EventDispatcher,Collection,DomUtils){"use strict";var hasMouseWheelEventSupport="onmousewheel"in document;var hasWheelEventSupport=false;var classPrefix="mce-";function getEventDispatcher(obj){if(!obj._eventDispatcher){obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){if(state&&EventDispatcher.isNative(name)){if(!obj._nativeEvents){obj._nativeEvents={};}
obj._nativeEvents[name]=true;if(obj._rendered){obj.bindPendingEvents();}}}});}
return obj._eventDispatcher;}
var Control=Class.extend({Statics:{classPrefix:classPrefix},isRtl:function(){return Control.rtl;},classPrefix:classPrefix,init:function(settings){var self=this,classes,i;self.settings=settings=Tools.extend({},self.Defaults,settings);self._id=settings.id||DomUtils.id();self._text=self._name='';self._width=self._height=0;self._aria={role:settings.role};this._elmCache={};classes=settings.classes;if(classes){classes=classes.split(' ');classes.map={};i=classes.length;while(i--){classes.map[classes[i]]=true;}}
self._classes=classes||[];self.visible(true);Tools.each('title text width height name classes visible disabled active value'.split(' '),function(name){var value=settings[name],undef;if(value!==undef){self[name](value);}else if(self['_'+name]===undef){self['_'+name]=false;}});self.on('click',function(){if(self.disabled()){return false;}});if(settings.classes){Tools.each(settings.classes.split(' '),function(cls){self.addClass(cls);});}
self.settings=settings;self._borderBox=self.parseBox(settings.border);self._paddingBox=self.parseBox(settings.padding);self._marginBox=self.parseBox(settings.margin);if(settings.hidden){self.hide();}},Properties:'parent,title,text,width,height,disabled,active,name,value',Methods:'renderHtml',getContainerElm:function(){return document.body;},getParentCtrl:function(elm){var ctrl,lookup=this.getRoot().controlIdLookup;while(elm&&lookup){ctrl=lookup[elm.id];if(ctrl){break;}
elm=elm.parentNode;}
return ctrl;},parseBox:function(value){var len,radix=10;if(!value){return;}
if(typeof(value)==="number"){value=value||0;return{top:value,left:value,bottom:value,right:value};}
value=value.split(' ');len=value.length;if(len===1){value[1]=value[2]=value[3]=value[0];}else if(len===2){value[2]=value[0];value[3]=value[1];}else if(len===3){value[3]=value[1];}
return{top:parseInt(value[0],radix)||0,right:parseInt(value[1],radix)||0,bottom:parseInt(value[2],radix)||0,left:parseInt(value[3],radix)||0};},borderBox:function(){return this._borderBox;},paddingBox:function(){return this._paddingBox;},marginBox:function(){return this._marginBox;},measureBox:function(elm,prefix){function getStyle(name){var defaultView=document.defaultView;if(defaultView){name=name.replace(/[A-Z]/g,function(a){return'-'+a;});return defaultView.getComputedStyle(elm,null).getPropertyValue(name);}
return elm.currentStyle[name];}
function getSide(name){var val=parseFloat(getStyle(name),10);return isNaN(val)?0:val;}
return{top:getSide(prefix+"TopWidth"),right:getSide(prefix+"RightWidth"),bottom:getSide(prefix+"BottomWidth"),left:getSide(prefix+"LeftWidth")};},initLayoutRect:function(){var self=this,settings=self.settings,borderBox,layoutRect;var elm=self.getEl(),width,height,minWidth,minHeight,autoResize;var startMinWidth,startMinHeight,initialSize;borderBox=self._borderBox=self._borderBox||self.measureBox(elm,'border');self._paddingBox=self._paddingBox||self.measureBox(elm,'padding');self._marginBox=self._marginBox||self.measureBox(elm,'margin');initialSize=DomUtils.getSize(elm);startMinWidth=settings.minWidth;startMinHeight=settings.minHeight;minWidth=startMinWidth||initialSize.width;minHeight=startMinHeight||initialSize.height;width=settings.width;height=settings.height;autoResize=settings.autoResize;autoResize=typeof(autoResize)!="undefined"?autoResize:!width&&!height;width=width||minWidth;height=height||minHeight;var deltaW=borderBox.left+borderBox.right;var deltaH=borderBox.top+borderBox.bottom;var maxW=settings.maxWidth||0xFFFF;var maxH=settings.maxHeight||0xFFFF;self._layoutRect=layoutRect={x:settings.x||0,y:settings.y||0,w:width,h:height,deltaW:deltaW,deltaH:deltaH,contentW:width-deltaW,contentH:height-deltaH,innerW:width-deltaW,innerH:height-deltaH,startMinWidth:startMinWidth||0,startMinHeight:startMinHeight||0,minW:Math.min(minWidth,maxW),minH:Math.min(minHeight,maxH),maxW:maxW,maxH:maxH,autoResize:autoResize,scrollW:0};self._lastLayoutRect={};return layoutRect;},layoutRect:function(newRect){var self=this,curRect=self._layoutRect,lastLayoutRect,size,deltaWidth,deltaHeight,undef,repaintControls;if(!curRect){curRect=self.initLayoutRect();}
if(newRect){deltaWidth=curRect.deltaW;deltaHeight=curRect.deltaH;if(newRect.x!==undef){curRect.x=newRect.x;}
if(newRect.y!==undef){curRect.y=newRect.y;}
if(newRect.minW!==undef){curRect.minW=newRect.minW;}
if(newRect.minH!==undef){curRect.minH=newRect.minH;}
size=newRect.w;if(size!==undef){size=size<curRect.minW?curRect.minW:size;size=size>curRect.maxW?curRect.maxW:size;curRect.w=size;curRect.innerW=size-deltaWidth;}
size=newRect.h;if(size!==undef){size=size<curRect.minH?curRect.minH:size;size=size>curRect.maxH?curRect.maxH:size;curRect.h=size;curRect.innerH=size-deltaHeight;}
size=newRect.innerW;if(size!==undef){size=size<curRect.minW-deltaWidth?curRect.minW-deltaWidth:size;size=size>curRect.maxW-deltaWidth?curRect.maxW-deltaWidth:size;curRect.innerW=size;curRect.w=size+deltaWidth;}
size=newRect.innerH;if(size!==undef){size=size<curRect.minH-deltaHeight?curRect.minH-deltaHeight:size;size=size>curRect.maxH-deltaHeight?curRect.maxH-deltaHeight:size;curRect.innerH=size;curRect.h=size+deltaHeight;}
if(newRect.contentW!==undef){curRect.contentW=newRect.contentW;}
if(newRect.contentH!==undef){curRect.contentH=newRect.contentH;}
lastLayoutRect=self._lastLayoutRect;if(lastLayoutRect.x!==curRect.x||lastLayoutRect.y!==curRect.y||lastLayoutRect.w!==curRect.w||lastLayoutRect.h!==curRect.h){repaintControls=Control.repaintControls;if(repaintControls){if(repaintControls.map&&!repaintControls.map[self._id]){repaintControls.push(self);repaintControls.map[self._id]=true;}}
lastLayoutRect.x=curRect.x;lastLayoutRect.y=curRect.y;lastLayoutRect.w=curRect.w;lastLayoutRect.h=curRect.h;}
return self;}
return curRect;},repaint:function(){var self=this,style,bodyStyle,rect,borderBox,borderW=0,borderH=0,lastRepaintRect,round;round=!document.createRange?Math.round:function(value){return value;};style=self.getEl().style;rect=self._layoutRect;lastRepaintRect=self._lastRepaintRect||{};borderBox=self._borderBox;borderW=borderBox.left+borderBox.right;borderH=borderBox.top+borderBox.bottom;if(rect.x!==lastRepaintRect.x){style.left=round(rect.x)+'px';lastRepaintRect.x=rect.x;}
if(rect.y!==lastRepaintRect.y){style.top=round(rect.y)+'px';lastRepaintRect.y=rect.y;}
if(rect.w!==lastRepaintRect.w){style.width=round(rect.w-borderW)+'px';lastRepaintRect.w=rect.w;}
if(rect.h!==lastRepaintRect.h){style.height=round(rect.h-borderH)+'px';lastRepaintRect.h=rect.h;}
if(self._hasBody&&rect.innerW!==lastRepaintRect.innerW){bodyStyle=self.getEl('body').style;bodyStyle.width=round(rect.innerW)+'px';lastRepaintRect.innerW=rect.innerW;}
if(self._hasBody&&rect.innerH!==lastRepaintRect.innerH){bodyStyle=bodyStyle||self.getEl('body').style;bodyStyle.height=round(rect.innerH)+'px';lastRepaintRect.innerH=rect.innerH;}
self._lastRepaintRect=lastRepaintRect;self.fire('repaint',{},false);},on:function(name,callback){var self=this;function resolveCallbackName(name){var callback,scope;if(typeof(name)!='string'){return name;}
return function(e){if(!callback){self.parentsAndSelf().each(function(ctrl){var callbacks=ctrl.settings.callbacks;if(callbacks&&(callback=callbacks[name])){scope=ctrl;return false;}});}
return callback.call(scope,e);};}
getEventDispatcher(self).on(name,resolveCallbackName(callback));return self;},off:function(name,callback){getEventDispatcher(this).off(name,callback);return this;},fire:function(name,args,bubble){var self=this;args=args||{};if(!args.control){args.control=self;}
args=getEventDispatcher(self).fire(name,args);if(bubble!==false&&self.parent){var parent=self.parent();while(parent&&!args.isPropagationStopped()){parent.fire(name,args,false);parent=parent.parent();}}
return args;},hasEventListeners:function(name){return getEventDispatcher(this).has(name);},parents:function(selector){var self=this,ctrl,parents=new Collection();for(ctrl=self.parent();ctrl;ctrl=ctrl.parent()){parents.add(ctrl);}
if(selector){parents=parents.filter(selector);}
return parents;},parentsAndSelf:function(selector){return new Collection(this).add(this.parents(selector));},next:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)+1];},prev:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)-1];},findCommonAncestor:function(ctrl1,ctrl2){var parentCtrl;while(ctrl1){parentCtrl=ctrl2;while(parentCtrl&&ctrl1!=parentCtrl){parentCtrl=parentCtrl.parent();}
if(ctrl1==parentCtrl){break;}
ctrl1=ctrl1.parent();}
return ctrl1;},hasClass:function(cls,group){var classes=this._classes[group||'control'];cls=this.classPrefix+cls;return classes&&!!classes.map[cls];},addClass:function(cls,group){var self=this,classes,elm;cls=this.classPrefix+cls;classes=self._classes[group||'control'];if(!classes){classes=[];classes.map={};self._classes[group||'control']=classes;}
if(!classes.map[cls]){classes.map[cls]=cls;classes.push(cls);if(self._rendered){elm=self.getEl(group);if(elm){elm.className=classes.join(' ');}}}
return self;},removeClass:function(cls,group){var self=this,classes,i,elm;cls=this.classPrefix+cls;classes=self._classes[group||'control'];if(classes&&classes.map[cls]){delete classes.map[cls];i=classes.length;while(i--){if(classes[i]===cls){classes.splice(i,1);}}}
if(self._rendered){elm=self.getEl(group);if(elm){elm.className=classes.join(' ');}}
return self;},toggleClass:function(cls,state,group){var self=this;if(state){self.addClass(cls,group);}else{self.removeClass(cls,group);}
return self;},classes:function(group){var classes=this._classes[group||'control'];return classes?classes.join(' '):'';},innerHtml:function(html){DomUtils.innerHtml(this.getEl(),html);return this;},getEl:function(suffix){var id=suffix?this._id+'-'+suffix:this._id;if(!this._elmCache[id]){this._elmCache[id]=DomUtils.get(id);}
return this._elmCache[id];},visible:function(state){var self=this,parentCtrl;if(typeof(state)!=="undefined"){if(self._visible!==state){if(self._rendered){self.getEl().style.display=state?'':'none';}
self._visible=state;parentCtrl=self.parent();if(parentCtrl){parentCtrl._lastRect=null;}
self.fire(state?'show':'hide');}
return self;}
return self._visible;},show:function(){return this.visible(true);},hide:function(){return this.visible(false);},focus:function(){try{this.getEl().focus();}catch(ex){}
return this;},blur:function(){this.getEl().blur();return this;},aria:function(name,value){var self=this,elm=self.getEl(self.ariaTarget);if(typeof(value)==="undefined"){return self._aria[name];}else{self._aria[name]=value;}
if(self._rendered){elm.setAttribute(name=='role'?name:'aria-'+name,value);}
return self;},encode:function(text,translate){if(translate!==false){text=this.translate(text);}
return(text||'').replace(/[&<>"]/g,function(match){return'&#'+match.charCodeAt(0)+';';});},translate:function(text){return Control.translate?Control.translate(text):text;},before:function(items){var self=this,parent=self.parent();if(parent){parent.insert(items,parent.items().indexOf(self),true);}
return self;},after:function(items){var self=this,parent=self.parent();if(parent){parent.insert(items,parent.items().indexOf(self));}
return self;},remove:function(){var self=this,elm=self.getEl(),parent=self.parent(),newItems,i;if(self.items){var controls=self.items().toArray();i=controls.length;while(i--){controls[i].remove();}}
if(parent&&parent.items){newItems=[];parent.items().each(function(item){if(item!==self){newItems.push(item);}});parent.items().set(newItems);parent._lastRect=null;}
if(self._eventsRoot&&self._eventsRoot==self){DomUtils.off(elm);}
var lookup=self.getRoot().controlIdLookup;if(lookup){delete lookup[self._id];}
if(elm&&elm.parentNode){elm.parentNode.removeChild(elm);}
self._rendered=false;return self;},renderBefore:function(elm){var self=this;elm.parentNode.insertBefore(DomUtils.createFragment(self.renderHtml()),elm);self.postRender();return self;},renderTo:function(elm){var self=this;elm=elm||self.getContainerElm();elm.appendChild(DomUtils.createFragment(self.renderHtml()));self.postRender();return self;},postRender:function(){var self=this,settings=self.settings,elm,box,parent,name,parentEventsRoot;for(name in settings){if(name.indexOf("on")===0){self.on(name.substr(2),settings[name]);}}
if(self._eventsRoot){for(parent=self.parent();!parentEventsRoot&&parent;parent=parent.parent()){parentEventsRoot=parent._eventsRoot;}
if(parentEventsRoot){for(name in parentEventsRoot._nativeEvents){self._nativeEvents[name]=true;}}}
self.bindPendingEvents();if(settings.style){elm=self.getEl();if(elm){elm.setAttribute('style',settings.style);elm.style.cssText=settings.style;}}
if(!self._visible){DomUtils.css(self.getEl(),'display','none');}
if(self.settings.border){box=self.borderBox();DomUtils.css(self.getEl(),{'border-top-width':box.top,'border-right-width':box.right,'border-bottom-width':box.bottom,'border-left-width':box.left});}
var root=self.getRoot();if(!root.controlIdLookup){root.controlIdLookup={};}
root.controlIdLookup[self._id]=self;for(var key in self._aria){self.aria(key,self._aria[key]);}
self.fire('postrender',{},false);},scrollIntoView:function(align){function getOffset(elm,rootElm){var x,y,parent=elm;x=y=0;while(parent&&parent!=rootElm&&parent.nodeType){x+=parent.offsetLeft||0;y+=parent.offsetTop||0;parent=parent.offsetParent;}
return{x:x,y:y};}
var elm=this.getEl(),parentElm=elm.parentNode;var x,y,width,height,parentWidth,parentHeight;var pos=getOffset(elm,parentElm);x=pos.x;y=pos.y;width=elm.offsetWidth;height=elm.offsetHeight;parentWidth=parentElm.clientWidth;parentHeight=parentElm.clientHeight;if(align=="end"){x-=parentWidth-width;y-=parentHeight-height;}else if(align=="center"){x-=(parentWidth/2)-(width/2);y-=(parentHeight/2)-(height/2);}
parentElm.scrollLeft=x;parentElm.scrollTop=y;return this;},bindPendingEvents:function(){var self=this,i,l,parents,eventRootCtrl,nativeEvents,name;function delegate(e){var control=self.getParentCtrl(e.target);if(control){control.fire(e.type,e);}}
function mouseLeaveHandler(){var ctrl=eventRootCtrl._lastHoverCtrl;if(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()});ctrl.parents().each(function(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()});});eventRootCtrl._lastHoverCtrl=null;}}
function mouseEnterHandler(e){var ctrl=self.getParentCtrl(e.target),lastCtrl=eventRootCtrl._lastHoverCtrl,idx=0,i,parents,lastParents;if(ctrl!==lastCtrl){eventRootCtrl._lastHoverCtrl=ctrl;parents=ctrl.parents().toArray().reverse();parents.push(ctrl);if(lastCtrl){lastParents=lastCtrl.parents().toArray().reverse();lastParents.push(lastCtrl);for(idx=0;idx<lastParents.length;idx++){if(parents[idx]!==lastParents[idx]){break;}}
for(i=lastParents.length-1;i>=idx;i--){lastCtrl=lastParents[i];lastCtrl.fire("mouseleave",{target:lastCtrl.getEl()});}}
for(i=idx;i<parents.length;i++){ctrl=parents[i];ctrl.fire("mouseenter",{target:ctrl.getEl()});}}}
function fixWheelEvent(e){e.preventDefault();if(e.type=="mousewheel"){e.deltaY=-1/40*e.wheelDelta;if(e.wheelDeltaX){e.deltaX=-1/40*e.wheelDeltaX;}}else{e.deltaX=0;e.deltaY=e.detail;}
e=self.fire("wheel",e);}
self._rendered=true;nativeEvents=self._nativeEvents;if(nativeEvents){parents=self.parents().toArray();parents.unshift(self);for(i=0,l=parents.length;!eventRootCtrl&&i<l;i++){eventRootCtrl=parents[i]._eventsRoot;}
if(!eventRootCtrl){eventRootCtrl=parents[parents.length-1]||self;}
self._eventsRoot=eventRootCtrl;for(l=i,i=0;i<l;i++){parents[i]._eventsRoot=eventRootCtrl;}
var eventRootDelegates=eventRootCtrl._delegates;if(!eventRootDelegates){eventRootDelegates=eventRootCtrl._delegates={};}
for(name in nativeEvents){if(!nativeEvents){return false;}
if(name==="wheel"&&!hasWheelEventSupport){if(hasMouseWheelEventSupport){DomUtils.on(self.getEl(),"mousewheel",fixWheelEvent);}else{DomUtils.on(self.getEl(),"DOMMouseScroll",fixWheelEvent);}
continue;}
if(name==="mouseenter"||name==="mouseleave"){if(!eventRootCtrl._hasMouseEnter){DomUtils.on(eventRootCtrl.getEl(),"mouseleave",mouseLeaveHandler);DomUtils.on(eventRootCtrl.getEl(),"mouseover",mouseEnterHandler);eventRootCtrl._hasMouseEnter=1;}}else if(!eventRootDelegates[name]){DomUtils.on(eventRootCtrl.getEl(),name,delegate);eventRootDelegates[name]=true;}
nativeEvents[name]=false;}}},getRoot:function(){var ctrl=this,rootControl,parents=[];while(ctrl){if(ctrl.rootControl){rootControl=ctrl.rootControl;break;}
parents.push(ctrl);rootControl=ctrl;ctrl=ctrl.parent();}
if(!rootControl){rootControl=this;}
var i=parents.length;while(i--){parents[i].rootControl=rootControl;}
return rootControl;},reflow:function(){this.repaint();return this;}});return Control;});