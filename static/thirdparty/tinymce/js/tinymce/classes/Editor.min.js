
define("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/dom/DomQuery","tinymce/AddOnManager","tinymce/NodeChange","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/EditorObservable","tinymce/Shortcuts"],function(DOMUtils,DomQuery,AddOnManager,NodeChange,Node,DomSerializer,Serializer,Selection,Formatter,UndoManager,EnterKey,ForceBlocks,EditorCommands,URI,ScriptLoader,EventUtils,WindowManager,Schema,DomParser,Quirks,Env,Tools,EditorObservable,Shortcuts){var DOM=DOMUtils.DOM,ThemeManager=AddOnManager.ThemeManager,PluginManager=AddOnManager.PluginManager;var extend=Tools.extend,each=Tools.each,explode=Tools.explode;var inArray=Tools.inArray,trim=Tools.trim,resolve=Tools.resolve;var Event=EventUtils.Event;var isGecko=Env.gecko,ie=Env.ie;function Editor(id,settings,editorManager){var self=this,documentBaseUrl,baseUri;documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL;baseUri=editorManager.baseURI;self.settings=settings=extend({id:id,theme:'modern',delta_width:0,delta_height:0,popup_css:'',plugins:'',document_base_url:documentBaseUrl,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:'<!DOCTYPE html>',visual:true,font_size_style_values:'xx-small,x-small,small,medium,large,x-large,xx-large',font_size_legacy_values:'xx-small,small,medium,large,x-large,xx-large,300%',forced_root_block:'p',hidden_input:true,padd_empty_editor:true,render_ui:true,indentation:'30px',inline_styles:true,convert_fonts_to_spans:true,indent:'simple',indent_before:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist',indent_after:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist',validate:true,entity_encoding:'named',url_converter:self.convertURL,url_converter_scope:self,ie7_compat:true},settings);AddOnManager.language=settings.language||'en';AddOnManager.languageLoad=settings.language_load;AddOnManager.baseURL=editorManager.baseURL;self.id=settings.id=id;self.isNotDirty=true;self.plugins={};self.documentBaseURI=new URI(settings.document_base_url||documentBaseUrl,{base_uri:baseUri});self.baseURI=baseUri;self.contentCSS=[];self.contentStyles=[];self.shortcuts=new Shortcuts(self);self.execCommands={};self.queryStateCommands={};self.queryValueCommands={};self.loadedCSS={};if(settings.target){self.targetElm=settings.target;}
self.suffix=editorManager.suffix;self.editorManager=editorManager;self.inline=settings.inline;editorManager.fire('SetupEditor',self);self.execCallback('setup',self);self.$=DomQuery.overrideDefaults(function(){return{context:self.inline?self.getBody():self.getDoc(),element:self.getBody()};});}
Editor.prototype={render:function(){var self=this,settings=self.settings,id=self.id,suffix=self.suffix;function readyHandler(){DOM.unbind(window,'ready',readyHandler);self.render();}
if(!Event.domLoaded){DOM.bind(window,'ready',readyHandler);return;}
if(!self.getElement()){return;}
if(!Env.contentEditable){return;}
if(!settings.inline){self.orgVisibility=self.getElement().style.visibility;self.getElement().style.visibility='hidden';}else{self.inline=true;}
var form=self.getElement().form||DOM.getParent(id,'form');if(form){self.formElement=form;if(settings.hidden_input&&!/TEXTAREA|INPUT/i.test(self.getElement().nodeName)){DOM.insertAfter(DOM.create('input',{type:'hidden',name:id}),id);self.hasHiddenInput=true;}
self.formEventDelegate=function(e){self.fire(e.type,e);};DOM.bind(form,'submit reset',self.formEventDelegate);self.on('reset',function(){self.setContent(self.startContent,{format:'raw'});});if(settings.submit_patch&&!form.submit.nodeType&&!form.submit.length&&!form._mceOldSubmit){form._mceOldSubmit=form.submit;form.submit=function(){self.editorManager.triggerSave();self.isNotDirty=true;return form._mceOldSubmit(form);};}}
self.windowManager=new WindowManager(self);if(settings.encoding=='xml'){self.on('GetContent',function(e){if(e.save){e.content=DOM.encode(e.content);}});}
if(settings.add_form_submit_trigger){self.on('submit',function(){if(self.initialized){self.save();}});}
if(settings.add_unload_trigger){self._beforeUnload=function(){if(self.initialized&&!self.destroyed&&!self.isHidden()){self.save({format:'raw',no_events:true,set_dirty:false});}};self.editorManager.on('BeforeUnload',self._beforeUnload);}
function loadScripts(){var scriptLoader=ScriptLoader.ScriptLoader;if(settings.language&&settings.language!='en'&&!settings.language_url){settings.language_url=self.editorManager.baseURL+'/langs/'+settings.language+'.js';}
if(settings.language_url){scriptLoader.add(settings.language_url);}
if(settings.theme&&typeof settings.theme!="function"&&settings.theme.charAt(0)!='-'&&!ThemeManager.urls[settings.theme]){var themeUrl=settings.theme_url;if(themeUrl){themeUrl=self.documentBaseURI.toAbsolute(themeUrl);}else{themeUrl='themes/'+settings.theme+'/theme'+suffix+'.js';}
ThemeManager.load(settings.theme,themeUrl);}
if(Tools.isArray(settings.plugins)){settings.plugins=settings.plugins.join(' ');}
each(settings.external_plugins,function(url,name){PluginManager.load(name,url);settings.plugins+=' '+name;});each(settings.plugins.split(/[ ,]/),function(plugin){plugin=trim(plugin);if(plugin&&!PluginManager.urls[plugin]){if(plugin.charAt(0)=='-'){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);each(dependencies,function(dep){var defaultSettings={prefix:'plugins/',resource:dep,suffix:'/plugin'+suffix+'.js'};dep=PluginManager.createUrl(defaultSettings,dep);PluginManager.load(dep.resource,dep);});}else{PluginManager.load(plugin,{prefix:'plugins/',resource:plugin,suffix:'/plugin'+suffix+'.js'});}}});scriptLoader.loadQueue(function(){if(!self.removed){self.init();}});}
loadScripts();},init:function(){var self=this,settings=self.settings,elm=self.getElement();var w,h,minHeight,n,o,Theme,url,bodyId,bodyClass,re,i,initializedPlugins=[];self.rtl=this.editorManager.i18n.rtl;self.editorManager.add(self);settings.aria_label=settings.aria_label||DOM.getAttrib(elm,'aria-label',self.getLang('aria.rich_text_area'));if(settings.theme){if(typeof settings.theme!="function"){settings.theme=settings.theme.replace(/-/,'');Theme=ThemeManager.get(settings.theme);self.theme=new Theme(self,ThemeManager.urls[settings.theme]);if(self.theme.init){self.theme.init(self,ThemeManager.urls[settings.theme]||self.documentBaseUrl.replace(/\/$/,''),self.$);}}else{self.theme=settings.theme;}}
function initPlugin(plugin){var Plugin=PluginManager.get(plugin),pluginUrl,pluginInstance;pluginUrl=PluginManager.urls[plugin]||self.documentBaseUrl.replace(/\/$/,'');plugin=trim(plugin);if(Plugin&&inArray(initializedPlugins,plugin)===-1){each(PluginManager.dependencies(plugin),function(dep){initPlugin(dep);});pluginInstance=new Plugin(self,pluginUrl,self.$);self.plugins[plugin]=pluginInstance;if(pluginInstance.init){pluginInstance.init(self,pluginUrl);initializedPlugins.push(plugin);}}}
each(settings.plugins.replace(/\-/g,'').split(/[ ,]/),initPlugin);if(settings.render_ui&&self.theme){self.orgDisplay=elm.style.display;if(typeof settings.theme!="function"){w=settings.width||elm.style.width||elm.offsetWidth;h=settings.height||elm.style.height||elm.offsetHeight;minHeight=settings.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(''+w)){w=Math.max(parseInt(w,10),100);}
if(re.test(''+h)){h=Math.max(parseInt(h,10),minHeight);}
o=self.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height});if(!settings.content_editable){h=(o.iframeHeight||h)+(typeof(h)=='number'?(o.deltaHeight||0):'');if(h<minHeight){h=minHeight;}}}else{o=settings.theme(self,elm);if(o.editorContainer.nodeType){o.editorContainer=o.editorContainer.id=o.editorContainer.id||self.id+"_parent";}
if(o.iframeContainer.nodeType){o.iframeContainer=o.iframeContainer.id=o.iframeContainer.id||self.id+"_iframecontainer";}
h=o.iframeHeight||elm.offsetHeight;}
self.editorContainer=o.editorContainer;}
if(settings.content_css){each(explode(settings.content_css),function(u){self.contentCSS.push(self.documentBaseURI.toAbsolute(u));});}
if(settings.content_style){self.contentStyles.push(settings.content_style);}
if(settings.content_editable){elm=n=o=null;return self.initContentBody();}
self.iframeHTML=settings.doctype+'<html><head>';if(settings.document_base_url!=self.documentBaseUrl){self.iframeHTML+='<base href="'+self.documentBaseURI.getURI()+'" />';}
if(!Env.caretAfter&&settings.ie7_compat){self.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />';}
self.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(i=0;i<self.contentCSS.length;i++){var cssUrl=self.contentCSS[i];self.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+cssUrl+'" />';self.loadedCSS[cssUrl]=true;}
bodyId=settings.body_id||'tinymce';if(bodyId.indexOf('=')!=-1){bodyId=self.getParam('body_id','','hash');bodyId=bodyId[self.id]||bodyId;}
bodyClass=settings.body_class||'';if(bodyClass.indexOf('=')!=-1){bodyClass=self.getParam('body_class','','hash');bodyClass=bodyClass[self.id]||'';}
if(settings.content_security_policy){self.iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+settings.content_security_policy+'" />';}
self.iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+self.id+'"><br></body></html>';var domainRelaxUrl='javascript:(function(){'+'document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+self.id+'");document.write(ed.iframeHTML);'+'document.close();ed.initContentBody(true);})()';if(document.domain!=location.hostname){url=domainRelaxUrl;}
var ifr=DOM.create('iframe',{id:self.id+"_ifr",frameBorder:'0',allowTransparency:"true",title:self.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. "+"Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:'100%',height:h,display:'block'}});ifr.onload=function(){ifr.onload=null;self.fire("load");};DOM.setAttrib(ifr,"src",url||'javascript:""');self.contentAreaContainer=o.iframeContainer;self.iframeElement=ifr;n=DOM.add(o.iframeContainer,ifr);if(ie){try{self.getDoc();}catch(e){n.src=url=domainRelaxUrl;}}
if(o.editorContainer){DOM.get(o.editorContainer).style.display=self.orgDisplay;self.hidden=DOM.isHidden(o.editorContainer);}
self.getElement().style.display='none';DOM.setAttrib(self.id,'aria-hidden',true);if(!url){self.initContentBody();}
elm=n=o=null;},initContentBody:function(skipWrite){var self=this,settings=self.settings,targetElm=self.getElement(),doc=self.getDoc(),body,contentCssText;if(!settings.inline){self.getElement().style.visibility=self.orgVisibility;}
if(!skipWrite&&!settings.content_editable){doc.open();doc.write(self.iframeHTML);doc.close();}
if(settings.content_editable){self.on('remove',function(){var bodyEl=this.getBody();DOM.removeClass(bodyEl,'mce-content-body');DOM.removeClass(bodyEl,'mce-edit-focus');DOM.setAttrib(bodyEl,'contentEditable',null);});DOM.addClass(targetElm,'mce-content-body');self.contentDocument=doc=settings.content_document||document;self.contentWindow=settings.content_window||window;self.bodyElement=targetElm;settings.content_document=settings.content_window=null;settings.root_name=targetElm.nodeName.toLowerCase();}
body=self.getBody();body.disabled=true;if(!settings.readonly){if(self.inline&&DOM.getStyle(body,'position',true)=='static'){body.style.position='relative';}
body.contentEditable=self.getParam('content_editable_state',true);}
body.disabled=false;self.schema=new Schema(settings);self.dom=new DOMUtils(doc,{keep_values:true,url_converter:self.convertURL,url_converter_scope:self,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:true,root_element:self.inline?self.getBody():null,collect:settings.content_editable,schema:self.schema,onSetAttrib:function(e){self.fire('SetAttrib',e);}});self.parser=new DomParser(settings,self.schema);self.parser.addAttributeFilter('src,href,style,tabindex',function(nodes,name){var i=nodes.length,node,dom=self.dom,value,internalName;while(i--){node=nodes[i];value=node.attr(name);internalName='data-mce-'+name;if(!node.attributes.map[internalName]){if(name==="style"){value=dom.serializeStyle(dom.parseStyle(value),node.name);if(!value.length){value=null;}
node.attr(internalName,value);node.attr(name,value);}else if(name==="tabindex"){node.attr(internalName,value);node.attr(name,null);}else{node.attr(internalName,self.convertURL(value,name,node.name));}}}});self.parser.addNodeFilter('script',function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.attr('type','mce-'+(node.attr('type')||'no/type'));}});self.parser.addNodeFilter('#cdata',function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.type=8;node.name='#comment';node.value='[CDATA['+node.value+']]';}});self.parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div',function(nodes){var i=nodes.length,node,nonEmptyElements=self.schema.getNonEmptyElements();while(i--){node=nodes[i];if(node.isEmpty(nonEmptyElements)){node.append(new Node('br',1)).shortEnded=true;}}});self.serializer=new DomSerializer(settings,self);self.selection=new Selection(self.dom,self.getWin(),self.serializer,self);self.formatter=new Formatter(self);self.undoManager=new UndoManager(self);self.forceBlocks=new ForceBlocks(self);self.enterKey=new EnterKey(self);self.editorCommands=new EditorCommands(self);self._nodeChangeDispatcher=new NodeChange(self);self.fire('PreInit');if(!settings.browser_spellcheck&&!settings.gecko_spellcheck){doc.body.spellcheck=false;DOM.setAttrib(body,"spellcheck","false");}
self.fire('PostRender');self.quirks=new Quirks(self);if(settings.directionality){body.dir=settings.directionality;}
if(settings.nowrap){body.style.whiteSpace="nowrap";}
if(settings.protect){self.on('BeforeSetContent',function(e){each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return'<!--mce:protected '+escape(str)+'-->';});});});}
self.on('SetContent',function(){self.addVisual(self.getBody());});if(settings.padd_empty_editor){self.on('PostProcess',function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,'');});}
self.load({initial:true,format:'html'});self.startContent=self.getContent({format:'raw'});self.initialized=true;self.bindPendingEventDelegates();self.fire('init');self.focus(true);self.nodeChanged({initial:true});self.execCallback('init_instance_callback',self);if(self.contentStyles.length>0){contentCssText='';each(self.contentStyles,function(style){contentCssText+=style+"\r\n";});self.dom.addStyle(contentCssText);}
each(self.contentCSS,function(cssUrl){if(!self.loadedCSS[cssUrl]){self.dom.loadCSS(cssUrl);self.loadedCSS[cssUrl]=true;}});if(settings.auto_focus){setTimeout(function(){var editor;if(settings.auto_focus===true){editor=self;}else{editor=self.editorManager.get(settings.auto_focus);}
editor.focus();},100);}
targetElm=doc=body=null;},focus:function(skipFocus){var self=this,selection=self.selection,contentEditable=self.settings.content_editable,rng;var controlElm,doc=self.getDoc(),body;if(!skipFocus){rng=selection.getRng();if(rng.item){controlElm=rng.item(0);}
self._refreshContentEditable();if(!contentEditable){if(!Env.opera){self.getBody().focus();}
self.getWin().focus();}
if(isGecko||contentEditable){body=self.getBody();if(body.setActive){try{body.setActive();}catch(ex){body.focus();}}else{body.focus();}
if(contentEditable){selection.normalize();}}
if(controlElm&&controlElm.ownerDocument==doc){rng=doc.body.createControlRange();rng.addElement(controlElm);rng.select();}}
self.editorManager.setActive(self);},execCallback:function(name){var self=this,callback=self.settings[name],scope;if(!callback){return;}
if(self.callbackLookup&&(scope=self.callbackLookup[name])){callback=scope.func;scope=scope.scope;}
if(typeof(callback)==='string'){scope=callback.replace(/\.\w+$/,'');scope=scope?resolve(scope):0;callback=resolve(callback);self.callbackLookup=self.callbackLookup||{};self.callbackLookup[name]={func:callback,scope:scope};}
return callback.apply(scope||self,Array.prototype.slice.call(arguments,1));},translate:function(text){var lang=this.settings.language||'en',i18n=this.editorManager.i18n;if(!text){return'';}
return i18n.data[lang+'.'+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n.data[lang+'.'+b]||'{#'+b+'}';});},getLang:function(name,defaultVal){return(this.editorManager.i18n.data[(this.settings.language||'en')+'.'+name]||(defaultVal!==undefined?defaultVal:'{#'+name+'}'));},getParam:function(name,defaultVal,type){var value=name in this.settings?this.settings[name]:defaultVal,output;if(type==='hash'){output={};if(typeof(value)==='string'){each(value.indexOf('=')>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(','),function(value){value=value.split('=');if(value.length>1){output[trim(value[0])]=trim(value[1]);}else{output[trim(value[0])]=trim(value);}});}else{output=value;}
return output;}
return value;},nodeChanged:function(args){this._nodeChangeDispatcher.nodeChanged(args);},addButton:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd);};}
if(!settings.text&&!settings.icon){settings.icon=name;}
self.buttons=self.buttons||{};settings.tooltip=settings.tooltip||settings.title;self.buttons[name]=settings;},addMenuItem:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd);};}
self.menuItems=self.menuItems||{};self.menuItems[name]=settings;},addCommand:function(name,callback,scope){this.execCommands[name]={func:callback,scope:scope||this};},addQueryStateHandler:function(name,callback,scope){this.queryStateCommands[name]={func:callback,scope:scope||this};},addQueryValueHandler:function(name,callback,scope){this.queryValueCommands[name]={func:callback,scope:scope||this};},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope);},execCommand:function(cmd,ui,value,args){var self=this,state=0,cmdItem;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(cmd)&&(!args||!args.skip_focus)){self.focus();}
args=extend({},args);args=self.fire('BeforeExecCommand',{command:cmd,ui:ui,value:value});if(args.isDefaultPrevented()){return false;}
if((cmdItem=self.execCommands[cmd])){if(cmdItem.func.call(cmdItem.scope,ui,value)!==true){self.fire('ExecCommand',{command:cmd,ui:ui,value:value});return true;}}
each(self.plugins,function(p){if(p.execCommand&&p.execCommand(cmd,ui,value)){self.fire('ExecCommand',{command:cmd,ui:ui,value:value});state=true;return false;}});if(state){return state;}
if(self.theme&&self.theme.execCommand&&self.theme.execCommand(cmd,ui,value)){self.fire('ExecCommand',{command:cmd,ui:ui,value:value});return true;}
if(self.editorCommands.execCommand(cmd,ui,value)){self.fire('ExecCommand',{command:cmd,ui:ui,value:value});return true;}
try{state=self.getDoc().execCommand(cmd,ui,value);}catch(ex){}
if(state){self.fire('ExecCommand',{command:cmd,ui:ui,value:value});return true;}
return false;},queryCommandState:function(cmd){var self=this,queryItem,returnVal;if(self._isHidden()){return;}
if((queryItem=self.queryStateCommands[cmd])){returnVal=queryItem.func.call(queryItem.scope);if(returnVal===true||returnVal===false){return returnVal;}}
returnVal=self.editorCommands.queryCommandState(cmd);if(returnVal!==-1){return returnVal;}
try{return self.getDoc().queryCommandState(cmd);}catch(ex){}},queryCommandValue:function(cmd){var self=this,queryItem,returnVal;if(self._isHidden()){return;}
if((queryItem=self.queryValueCommands[cmd])){returnVal=queryItem.func.call(queryItem.scope);if(returnVal!==true){return returnVal;}}
returnVal=self.editorCommands.queryCommandValue(cmd);if(returnVal!==undefined){return returnVal;}
try{return self.getDoc().queryCommandValue(cmd);}catch(ex){}},show:function(){var self=this;if(self.hidden){self.hidden=false;if(self.inline){self.getBody().contentEditable=true;}else{DOM.show(self.getContainer());DOM.hide(self.id);}
self.load();self.fire('show');}},hide:function(){var self=this,doc=self.getDoc();if(!self.hidden){if(ie&&doc&&!self.inline){doc.execCommand('SelectAll');}
self.save();if(self.inline){self.getBody().contentEditable=false;if(self==self.editorManager.focusedEditor){self.editorManager.focusedEditor=null;}}else{DOM.hide(self.getContainer());DOM.setStyle(self.id,'display',self.orgDisplay);}
self.hidden=true;self.fire('hide');}},isHidden:function(){return!!this.hidden;},setProgressState:function(state,time){this.fire('ProgressState',{state:state,time:time});},load:function(args){var self=this,elm=self.getElement(),html;if(elm){args=args||{};args.load=true;html=self.setContent(elm.value!==undefined?elm.value:elm.innerHTML,args);args.element=elm;if(!args.no_events){self.fire('LoadContent',args);}
args.element=elm=null;return html;}},save:function(args){var self=this,elm=self.getElement(),html,form;if(!elm||!self.initialized){return;}
args=args||{};args.save=true;args.element=elm;html=args.content=self.getContent(args);if(!args.no_events){self.fire('SaveContent',args);}
html=args.content;if(!/TEXTAREA|INPUT/i.test(elm.nodeName)){if(!self.inline){elm.innerHTML=html;}
if((form=DOM.getParent(self.id,'form'))){each(form.elements,function(elm){if(elm.name==self.id){elm.value=html;return false;}});}}else{elm.value=html;}
args.element=elm=null;if(args.set_dirty!==false){self.isNotDirty=true;}
return html;},setContent:function(content,args){var self=this,body=self.getBody(),forcedRootBlockName;args=args||{};args.format=args.format||'html';args.set=true;args.content=content;if(!args.no_events){self.fire('BeforeSetContent',args);}
content=args.content;if(content.length===0||/^\s+$/.test(content)){forcedRootBlockName=self.settings.forced_root_block;if(forcedRootBlockName&&self.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())){content=ie&&ie<11?'':'<br data-mce-bogus="1">';content=self.dom.createHTML(forcedRootBlockName,self.settings.forced_root_block_attrs,content);}else if(!ie){content='<br data-mce-bogus="1">';}
self.dom.setHTML(body,content);self.fire('SetContent',args);}else{if(args.format!=='raw'){content=new Serializer({},self.schema).serialize(self.parser.parse(content,{isRootContent:true}));}
args.content=trim(content);self.dom.setHTML(body,args.content);if(!args.no_events){self.fire('SetContent',args);}}
return args.content;},getContent:function(args){var self=this,content,body=self.getBody();args=args||{};args.format=args.format||'html';args.get=true;args.getInner=true;if(!args.no_events){self.fire('BeforeGetContent',args);}
if(args.format=='raw'){content=body.innerHTML;}else if(args.format=='text'){content=body.innerText||body.textContent;}else{content=self.serializer.serialize(body,args);}
if(args.format!='text'){args.content=trim(content);}else{args.content=content;}
if(!args.no_events){self.fire('GetContent',args);}
return args.content;},insertContent:function(content,args){if(args){content=extend({content:content},args);}
this.execCommand('mceInsertContent',false,content);},isDirty:function(){return!this.isNotDirty;},getContainer:function(){var self=this;if(!self.container){self.container=DOM.get(self.editorContainer||self.id+'_parent');}
return self.container;},getContentAreaContainer:function(){return this.contentAreaContainer;},getElement:function(){if(!this.targetElm){this.targetElm=DOM.get(this.id);}
return this.targetElm;},getWin:function(){var self=this,elm;if(!self.contentWindow){elm=self.iframeElement;if(elm){self.contentWindow=elm.contentWindow;}}
return self.contentWindow;},getDoc:function(){var self=this,win;if(!self.contentDocument){win=self.getWin();if(win){self.contentDocument=win.document;}}
return self.contentDocument;},getBody:function(){return this.bodyElement||this.getDoc().body;},convertURL:function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback){return self.execCallback('urlconverter_callback',url,elm,true,name);}
if(!settings.convert_urls||(elm&&elm.nodeName=='LINK')||url.indexOf('file:')===0||url.length===0){return url;}
if(settings.relative_urls){return self.documentBaseURI.toRelative(url);}
url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url;},addVisual:function(elm){var self=this,settings=self.settings,dom=self.dom,cls;elm=elm||self.getBody();if(self.hasVisual===undefined){self.hasVisual=settings.visual;}
each(dom.select('table,a',elm),function(elm){var value;switch(elm.nodeName){case'TABLE':cls=settings.visual_table_class||'mce-item-table';value=dom.getAttrib(elm,'border');if((!value||value=='0')&&self.hasVisual){dom.addClass(elm,cls);}else{dom.removeClass(elm,cls);}
return;case'A':if(!dom.getAttrib(elm,'href',false)){value=dom.getAttrib(elm,'name')||elm.id;cls=settings.visual_anchor_class||'mce-item-anchor';if(value&&self.hasVisual){dom.addClass(elm,cls);}else{dom.removeClass(elm,cls);}}
return;}});self.fire('VisualAid',{element:elm,hasVisual:self.hasVisual});},remove:function(){var self=this;if(!self.removed){self.save();self.removed=1;self.unbindAllNativeEvents();if(self.hasHiddenInput){DOM.remove(self.getElement().nextSibling);}
if(!self.inline){if(ie&&ie<10){self.getDoc().execCommand('SelectAll',false,null);}
DOM.setStyle(self.id,'display',self.orgDisplay);self.getBody().onload=null;}
self.fire('remove');self.editorManager.remove(self);DOM.remove(self.getContainer());self.destroy();}},destroy:function(automatic){var self=this,form;if(self.destroyed){return;}
if(!automatic&&!self.removed){self.remove();return;}
if(!automatic){self.editorManager.off('beforeunload',self._beforeUnload);if(self.theme&&self.theme.destroy){self.theme.destroy();}
self.selection.destroy();self.dom.destroy();}
form=self.formElement;if(form){if(form._mceOldSubmit){form.submit=form._mceOldSubmit;form._mceOldSubmit=null;}
DOM.unbind(form,'submit reset',self.formEventDelegate);}
self.contentAreaContainer=self.formElement=self.container=self.editorContainer=null;self.bodyElement=self.contentDocument=self.contentWindow=null;self.iframeElement=self.targetElm=null;if(self.selection){self.selection=self.selection.win=self.selection.dom=self.selection.dom.doc=null;}
self.destroyed=1;},_refreshContentEditable:function(){var self=this,body,parent;if(self._isHidden()){body=self.getBody();parent=body.parentNode;parent.removeChild(body);parent.appendChild(body);body.focus();}},_isHidden:function(){var sel;if(!isGecko){return 0;}
sel=this.selection.getSel();return(!sel||!sel.rangeCount||sel.rangeCount===0);}};extend(Editor.prototype,EditorObservable);return Editor;});