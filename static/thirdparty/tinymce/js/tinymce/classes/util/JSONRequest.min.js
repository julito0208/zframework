
define("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(JSON,XHR,Tools){var extend=Tools.extend;function JSONRequest(settings){this.settings=extend({},settings);this.count=0;}
JSONRequest.sendRPC=function(o){return new JSONRequest().send(o);};JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend(this.settings,args);args.success=function(c,x){c=JSON.parse(c);if(typeof(c)=='undefined'){c={error:'JSON Parse error.'};}
if(c.error){ecb.call(args.error_scope||args.scope,c.error,x);}else{scb.call(args.success_scope||args.scope,c.result);}};args.error=function(ty,x){if(ecb){ecb.call(args.error_scope||args.scope,ty,x);}};args.data=JSON.serialize({id:args.id||'c'+(this.count++),method:args.method,params:args.params});args.content_type='application/json';XHR.send(args);}};return JSONRequest;});