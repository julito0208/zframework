
define("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DomQuery","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(Editor,DomQuery,DOMUtils,URI,Env,Tools,Observable,I18n,FocusManager){var DOM=DOMUtils.DOM;var explode=Tools.explode,each=Tools.each,extend=Tools.extend;var instanceCounter=0,beforeUnloadDelegate,EditorManager;function removeEditorFromList(editor){var editors=EditorManager.editors,removedFromList;delete editors[editor.id];for(var i=0;i<editors.length;i++){if(editors[i]==editor){editors.splice(i,1);removedFromList=true;break;}}
if(EditorManager.activeEditor==editor){EditorManager.activeEditor=editors[0];}
if(EditorManager.focusedEditor==editor){EditorManager.focusedEditor=null;}
return removedFromList;}
function purgeDestroyedEditor(editor){if(editor&&!(editor.getContainer()||editor.getBody()).parentNode){removeEditorFromList(editor);editor.unbindAllNativeEvents();editor.destroy(true);editor=null;}
return editor;}
EditorManager={$:DomQuery,majorVersion:'@@majorVersion@@',minorVersion:'@@minorVersion@@',releaseDate:'@@releaseDate@@',editors:[],i18n:I18n,activeEditor:null,setup:function(){var self=this,baseURL,documentBaseURL,suffix="",preInit,src;documentBaseURL=document.location.href;if(/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)){documentBaseURL=documentBaseURL.replace(/[\?#].*$/,'').replace(/[\/\\][^\/]+$/,'');if(!/[\/\\]$/.test(documentBaseURL)){documentBaseURL+='/';}}
preInit=window.tinymce||window.tinyMCEPreInit;if(preInit){baseURL=preInit.base||preInit.baseURL;suffix=preInit.suffix;}else{var scripts=document.getElementsByTagName('script');for(var i=0;i<scripts.length;i++){src=scripts[i].src;if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){if(src.indexOf('.min')!=-1){suffix='.min';}
baseURL=src.substring(0,src.lastIndexOf('/'));break;}}
if(!baseURL&&document.currentScript){src=document.currentScript.src;if(src.indexOf('.min')!=-1){suffix='.min';}
baseURL=src.substring(0,src.lastIndexOf('/'));}}
self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL);self.documentBaseURL=documentBaseURL;self.baseURI=new URI(self.baseURL);self.suffix=suffix;self.focusManager=new FocusManager(self);},init:function(settings){var self=this,editors=[];function createId(elm){var id=elm.id;if(!id){id=elm.name;if(id&&!DOM.get(id)){id=elm.name;}else{id=DOM.uniqueId();}
elm.setAttribute('id',id);}
return id;}
function createEditor(id,settings,targetElm){if(!purgeDestroyedEditor(self.get(id))){var editor=new Editor(id,settings,self);editor.targetElm=editor.targetElm||targetElm;editors.push(editor);editor.render();}}
function execCallback(name){var callback=settings[name];if(!callback){return;}
return callback.apply(self,Array.prototype.slice.call(arguments,2));}
function hasClass(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM.hasClass(elm,className);}
function readyHandler(){var l,co;DOM.unbind(window,'ready',readyHandler);execCallback('onpageload');if(settings.types){each(settings.types,function(type){each(DOM.select(type.selector),function(elm){createEditor(createId(elm),extend({},settings,type),elm);});});return;}else if(settings.selector){each(DOM.select(settings.selector),function(elm){createEditor(createId(elm),settings,elm);});return;}else if(settings.target){createEditor(createId(settings.target),settings);}
switch(settings.mode){case"exact":l=settings.elements||'';if(l.length>0){each(explode(l),function(id){var elm;if((elm=DOM.get(id))){createEditor(id,settings,elm);}else{each(document.forms,function(f){each(f.elements,function(e){if(e.name===id){id='mce_editor_'+instanceCounter++;DOM.setAttrib(e,'id',id);createEditor(id,settings,e);}});});}});}
break;case"textareas":case"specific_textareas":each(DOM.select('textarea'),function(elm){if(settings.editor_deselector&&hasClass(elm,settings.editor_deselector)){return;}
if(!settings.editor_selector||hasClass(elm,settings.editor_selector)){createEditor(createId(elm),settings,elm);}});break;}
if(settings.oninit){l=co=0;each(editors,function(ed){co++;if(!ed.initialized){ed.on('init',function(){l++;if(l==co){execCallback('oninit');}});}else{l++;}
if(l==co){execCallback('oninit');}});}}
self.settings=settings;DOM.bind(window,'ready',readyHandler);},get:function(id){if(!arguments.length){return this.editors;}
return id in this.editors?this.editors[id]:null;},add:function(editor){var self=this,editors=self.editors;editors[editor.id]=editor;editors.push(editor);self.activeEditor=editor;self.fire('AddEditor',{editor:editor});if(!beforeUnloadDelegate){beforeUnloadDelegate=function(){self.fire('BeforeUnload');};DOM.bind(window,'beforeunload',beforeUnloadDelegate);}
return editor;},createEditor:function(id,settings){return this.add(new Editor(id,settings,this));},remove:function(selector){var self=this,i,editors=self.editors,editor;if(!selector){for(i=editors.length-1;i>=0;i--){self.remove(editors[i]);}
return;}
if(typeof(selector)=="string"){selector=selector.selector||selector;each(DOM.select(selector),function(elm){editor=editors[elm.id];if(editor){self.remove(editor);}});return;}
editor=selector;if(!editors[editor.id]){return null;}
if(removeEditorFromList(editor)){self.fire('RemoveEditor',{editor:editor});}
if(!editors.length){DOM.unbind(window,'beforeunload',beforeUnloadDelegate);}
editor.remove();return editor;},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":if(!self.get(value)){new Editor(value,self.settings,self).render();}
return true;case"mceRemoveEditor":if(editor){editor.remove();}
return true;case'mceToggleEditor':if(!editor){self.execCommand('mceAddEditor',0,value);return true;}
if(editor.isHidden()){editor.show();}else{editor.hide();}
return true;}
if(self.activeEditor){return self.activeEditor.execCommand(cmd,ui,value);}
return false;},triggerSave:function(){each(this.editors,function(editor){editor.save();});},addI18n:function(code,items){I18n.add(code,items);},translate:function(text){return I18n.translate(text);},setActive:function(editor){var activeEditor=this.activeEditor;if(this.activeEditor!=editor){if(activeEditor){activeEditor.fire('deactivate',{relatedTarget:editor});}
editor.fire('activate',{relatedTarget:activeEditor});}
this.activeEditor=editor;}};extend(EditorManager,Observable);EditorManager.setup();window.tinymce=window.tinyMCE=EditorManager;return EditorManager;});