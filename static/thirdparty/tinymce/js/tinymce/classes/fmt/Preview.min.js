
define("tinymce/fmt/Preview",["tinymce/util/Tools"],function(Tools){var each=Tools.each;function getCssText(editor,format){var name,previewElm,dom=editor.dom;var previewCss='',parentFontSize,previewStyles;previewStyles=editor.settings.preview_styles;if(previewStyles===false){return'';}
if(!previewStyles){previewStyles='font-family font-size font-weight font-style text-decoration '+'text-transform color background-color border border-radius outline text-shadow';}
function removeVars(val){return val.replace(/%(\w+)/g,'');}
if(typeof(format)=="string"){format=editor.formatter.get(format);if(!format){return;}
format=format[0];}
name=format.block||format.inline||'span';previewElm=dom.create(name);each(format.styles,function(value,name){value=removeVars(value);if(value){dom.setStyle(previewElm,name,value);}});each(format.attributes,function(value,name){value=removeVars(value);if(value){dom.setAttrib(previewElm,name,value);}});each(format.classes,function(value){value=removeVars(value);if(!dom.hasClass(previewElm,value)){dom.addClass(previewElm,value);}});editor.fire('PreviewFormats');dom.setStyles(previewElm,{position:'absolute',left:-0xFFFF});editor.getBody().appendChild(previewElm);parentFontSize=dom.getStyle(editor.getBody(),'fontSize',true);parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0;each(previewStyles.split(' '),function(name){var value=dom.getStyle(previewElm,name,true);if(name=='background-color'&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)){value=dom.getStyle(editor.getBody(),name,true);if(dom.toHex(value).toLowerCase()=='#ffffff'){return;}}
if(name=='color'){if(dom.toHex(value).toLowerCase()=='#000000'){return;}}
if(name=='font-size'){if(/em|%$/.test(value)){if(parentFontSize===0){return;}
value=parseFloat(value,10)/(/%$/.test(value)?100:1);value=(value*parentFontSize)+'px';}}
if(name=="border"&&value){previewCss+='padding:0 2px;';}
previewCss+=name+':'+value+';';});editor.fire('AfterPreviewFormats');dom.remove(previewElm);return previewCss;}
return{getCssText:getCssText};});